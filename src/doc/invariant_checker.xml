<?xml version="1.0"?>

<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN" "http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd"[
<!ENTITY class_bdd_prover "<classname>BDD_Prover</classname>">
<!ENTITY class_invariant_checker "<classname>Invariant_Checker</classname>">
<!ENTITY class_bdd2dot "<classname>BDD2Dot</classname>">

<!ENTITY type_virtual "<type>virtual</type>">
<!ENTITY type_void "<type>void</type>">
<!ENTITY type_bool "<type>bool</type>">
<!ENTITY type_int "<type>int</type>">
<!ENTITY type_aterm "<type>ATerm</type>">
<!ENTITY type_aterm_appl "<type>ATermAppl</type>">
<!ENTITY type_smt_solver_type "<type>SMT_Solver_Type</type>">
<!ENTITY type_rewrite_strategy "<type>RewriteStrategy</type>">
<!ENTITY type_char_string "<type>char*</type>">

<!ENTITY invariant_checker_constructor "<function>Invariant_Checker::Invariant_Checker</function>">
<!ENTITY invariant_checker_check_invariant "<function>Invariant_Checker::check_invariant</function>">

<!ENTITY par_rewrite_strategy "<parameter>a_rewrite_strategy</parameter>">
<!ENTITY par_time_limit "<parameter>a_time_limit</parameter>">
<!ENTITY par_path_eliminator "<parameter>a_path_eliminator</parameter>">
<!ENTITY par_solver_type "<parameter>a_solver_type</parameter>">
<!ENTITY par_lpe "<parameter>a_lpe</parameter>">
<!ENTITY par_counter_example "<parameter>a_counter_example</parameter>">
<!ENTITY par_all_violations "<parameter>a_all_violations</parameter>">
<!ENTITY par_invariant "<parameter>a_invariant</parameter>">
<!ENTITY par_dot_file_name "<parameter>a_dot_file_name</parameter>">

<!ENTITY solver_ario "<constant>ario</constant>">
<!ENTITY solver_cvc_lite "<constant>cvc-lite</constant>">

<!ENTITY link_ario "<uri>http://www.eecs.umich.edu/~ario/</uri>">
<!ENTITY link_cvc "<uri>http://www.cs.nyu.edu/acsys/cvcl/</uri>">

<!ENTITY const_strat_jitty "<constant>GS_REWR_JITTY</constant>">
<!ENTITY const_strat_jittyc "<constant>GS_REWR_JITTYC</constant>">
<!ENTITY const_strat_inner "<constant>GS_REWR_INNER</constant>">
<!ENTITY const_strat_innerc "<constant>GS_REWR_INNERC</constant>">
<!ENTITY const_solver_type_ario "<constant>solver_type_ario</constant>">
<!ENTITY const_true "<constant>true</constant>">
<!ENTITY const_false "<constant>false</constant>">

<!ENTITY stderr "<constant>stderr</constant>">
]>

<refentry id="invariant_checker">

<refmeta>
<refentrytitle>invariant_checker</refentrytitle>
<manvolnum>7</manvolnum>
</refmeta>

<refnamediv>
<refname>invariant_checker</refname>
<refpurpose>a class that checks if a formula is an invariant of an mCRL2 LPE</refpurpose>
</refnamediv>

<refsynopsisdiv>
<funcsynopsis>
<funcprototype>
  <funcdef>&invariant_checker_constructor;</funcdef>
  <paramdef>&type_aterm_appl; &par_lpe;</paramdef>
  <paramdef>&type_rewrite_strategy; &par_rewrite_strategy; = &const_strat_jitty;</paramdef>
  <paramdef>&type_int; &par_time_limit; = 0</paramdef>
  <paramdef>&type_bool; &par_path_eliminator; = &const_false;</paramdef>
  <paramdef>&type_smt_solver_type; &par_solver_type; = &const_solver_type_ario;</paramdef>
  <paramdef>&type_bool; &par_counter_example; = &const_false;</paramdef>
  <paramdef>&type_bool; &par_all_violations; = &const_false;</paramdef>
  <paramdef>&type_char_string; &par_dot_file_name; = 0</paramdef>
</funcprototype>
<funcprototype>
  <funcdef>&type_aterm_appl; &invariant_checker_check_invariant;</funcdef>
  <paramdef>&type_aterm_appl; &par_invariant;</paramdef>
</funcprototype>
</funcsynopsis>
</refsynopsisdiv>

<refsect1>
<title>Description</title>
<para>
  The class &class_invariant_checker; is initialized with an LPE using the constructor &invariant_checker_constructor;. After initialization,
  the function &invariant_checker_check_invariant; can be called any number of times to check whether a formula passed as argument &par_invariant;
  is an invariant of this LPE. A new instance of the class &class_invariant_checker; has to be created for each new LPE that has to be checked.
</para>
<para>
  The class &class_invariant_checker; uses an instance of the class &class_bdd_prover; to check whether a formula is a valid invariant of an mCRL2
  LPE. The constructor &invariant_checker_constructor; initializes the BDD based prover with the parameters &par_rewrite_strategy;,
  &par_time_limit;,
  &par_path_eliminator;, &par_solver_type; and the data specification of the LPE passed as parameter &par_lpe;. The
  parameter &par_rewrite_strategy; specifies which rewrite strategy is used by the prover's rewriter. It can be set to either
  &const_strat_inner;, &const_strat_innerc;, &const_strat_jitty; or &const_strat_jittyc;. The parameter &par_time_limit; specifies the maximum
  amount of time in seconds to be spent by the prover on proving a single formula. If &par_time_limit; is set to 0, no time limit will be enforced.
  The parameter &par_path_eliminator; specifies whether or not path elimination is applied. When path elimination is applied, the prover uses an
  SMT solver to remove inconsistent paths from BDDs. The parameter &par_solver_type; specifies which SMT solver is used for path elimination. 
  Either the SMT solver &solver_ario; or &solver_cvc_lite; can be used. To use one of these solvers, the directory containing the corresponding
  executable must be in the path. On June the 20th of 2006, Ario was available on &link_ario; and CVC Lite was available on &link_cvc;.
  If the parameter &par_path_eliminator; is set to &const_false;, the parameter &par_solver_type; is ignored.
</para>
<para>
  The parameter &par_dot_file_name;
  specifies whether a file in dot format of the resulting BDD is saved each time the prover cannot determine whether a formula is a contradiction
  or a tautology. If the parameter is set to 0, no .dot files are saved. If a string is passed as parameter &par_dot_file_name;, this string will
  be used as the prefix of the filenames. An instance of the class &class_bdd2dot; is used to save these files in dot format.
</para>
<para>
  If the parameter &par_counter_example; is set to &const_true;, a so
  called counter example will be printed to &stderr; each time a summand is encountered that violates the invariant. A counter example is a
  valuation for which the formula to be proven does not
  hold. If the parameter &par_all_violations; is set to &const_true;, the invariant checker will not stop as soon as a violation of the invariant
  is found, but will report all violations instead.
</para>
<para>
  Given an LPE,
  <literallayout>
    P(d: D) = ...
            + sum ei: Ei. ci(d, ei) -> ai(fi(d, ei)) . P(gi(d, ei))
            + ...;
  </literallayout>
  an instance of the class &class_invariant_checker; will generate a formula of the form
  <literallayout>
    inv(d) /\ ci(d, ei) => inv(gi(d, ei))
  </literallayout>
  for each of the summands, where <literal>inv()</literal> is the formula passed as parameter &par_invariant;. If this formula passed as parameter
  &par_invariant; holds for the initial state and all the generated formulas are tautologies according to the prover, it is an invariant.
</para>
</refsect1>

<refsect1>
<title>Preconditions</title>
<para>
  The following precondition has to be satisfied for &invariant_checker_constructor;:
  <itemizedlist>
    <listitem>
      <para>the argument passed as parameter &par_lpe; is a valid mCRL2 LPE</para>
    </listitem>
    <listitem>
      <para>
        the argument passed as parameter &par_time_limit; is greater than or equal to 0. If the argument is equal to 0, no time limit will be
        enforced
      </para>
    </listitem>
  </itemizedlist>
</para>
<para>
  The following precondition has to be satisfied for &invariant_checker_check_invariant;:
  <itemizedlist>
    <listitem>
      <para>the argument passed as parameter &par_invariant; is a valid formula in internal mCRL2 format</para>
  </listitem>
  </itemizedlist>
</para>
</refsect1>

<refsect1>
<title>Author</title>
<para>
  Written by Luc Engelen. Please send all complaints, comments and bug reports to <email>bug@mcrl2.org</email>.
</para>
</refsect1>

</refentry>
