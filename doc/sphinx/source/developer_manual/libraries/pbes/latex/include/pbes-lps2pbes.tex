%TCIDATA{Version=5.50.0.2890}
%TCIDATA{LaTeXparent=1,1,pbes-implementation-notes.tex}
                      

\section{Transforming an LPS to a PBES}

In this section we define the algorithm \textsc{lps2pbes} that generates a
PBES from a state formula and an LPS. Let $\langle {D_{p},d_{0},P}\rangle $
be the LPS given by

\begin{equation*}
\begin{array}{lrl}
\mathbf{proc}~P(x{:}D_{p}) & = & \sum_{i\in
I}\sum_{y_{i}:E_{i}}c_{i}(x,y_{i})\rightarrow a_{i}(f_{i}(x,y_{i}))%
\mbox{\aap ,}t_{i}(x,y_{i})\cdot P(g_{i}(x,y_{i})) \\ 
& + & \sum_{j\in J}\sum_{y_{i}:E_{j}}c_{j}(x,y_{i})\rightarrow \delta %
\mbox{\aap ,}t_{j}(x,y_{i});%
\end{array}%
\end{equation*}%
where $a_{i}(f_{i}(x,y))$ is a multiset of actions. Then we define 
\begin{equation*}
\text{\textsc{lps2pbes}}(\sigma X(x_{f}:D_{f}:=d).~\varphi ,\langle {%
D_{p},d_{0},P}\rangle )=\mathbf{E}(\varphi ),
\end{equation*}%
where the function $\mathbf{E}$ is inductively defined using the tables
below. The function $\varphi $ has to be in positive normal form, i.e. it
may not contain any $\lnot $ or $\Rightarrow $ symbols. This is done using
the function $h$, as given below. There is also an untimed variant of the
algorithm, which can be obtained by removing all time references. A formula $%
\varphi $ not of the form $\sigma X(x_{f}:D_{f}:=d).~\varphi $ is first
translated into $\nu X().~\varphi $. We assume that $T:\mathbb{R}$ is a
unique fresh time variable that is generated by the algorithm.

\vspace{1cm}

%-------------------------------------%
%           function Sat
%-------------------------------------%
Let $a=\{a_{1},\ldots ,a_{n}\}$ and $b=\{b_{1},\ldots ,b_{n}\}$ be two multi
actions. Let $A$ be the set of all permutations $[i_{1},\ldots ,i_{n}]$ of $%
[1,\ldots n]$ such that $name(a_{k})=name(b_{i_{k}})$ for $k=1\ldots n$.
Then we define the function $\mathbf{Sat}$ as follows:

\begin{equation*}
\begin{array}{lll}
\mathbf{Sat}(a \mbox{\aap ,} t, b) & =_{def} & \left\{ 
\begin{array}{cc}
\dbigvee\limits_{\lbrack i_{1},\ldots ,i_{n}]\in
A}\dbigwedge\limits_{k=1\ldots n}(a_{k}=b_{i_{k}}) & \text{if }A\neq
\emptyset \\ 
false & \text{otherwise}%
\end{array}%
\right. \\ 
\mathbf{Sat}(a \mbox{\aap ,} t, c) & =_{def} & c \\ 
\mathbf{Sat}(a \mbox{\aap ,} t, \alpha \mbox{\aap ,} u) & =_{def} & \mathbf{%
Sat}(a \mbox{\aap ,} t, \alpha) \wedge t \approx u \\ 
\mathbf{Sat}(a \mbox{\aap ,} t, \neg \alpha) & =_{def} & \neg \mathbf{Sat}(a %
\mbox{\aap ,} t, \alpha) \\ 
\mathbf{Sat}(a \mbox{\aap ,} t, \alpha \wedge \beta) & =_{def} & \mathbf{Sat}%
(a \mbox{\aap ,} t, \alpha) \wedge \mathbf{Sat}(a \mbox{\aap ,} t, \beta) \\ 
\mathbf{Sat}(a \mbox{\aap ,} t, \alpha \vee \beta) & =_{def} & \mathbf{Sat}%
(a \mbox{\aap ,} t, \alpha) \vee \mathbf{Sat}(a \mbox{\aap ,} t, \beta) \\ 
\mathbf{Sat}(a \mbox{\aap ,} t, \alpha \Rightarrow \beta) & =_{def} & 
\mathbf{Sat}(a \mbox{\aap ,} t, \alpha) \Rightarrow \mathbf{Sat}(a %
\mbox{\aap ,} t, \beta) \\ 
\mathbf{Sat}(a \mbox{\aap ,} t, \forall{x {:} D}. \alpha) & =_{def} & \forall%
{y {:} D}. (\mathbf{Sat}(a \mbox{\aap ,} t, \alpha[x := y]) \\ 
\mathbf{Sat}(a \mbox{\aap ,} t, \exists{x {:} D}. \alpha) & =_{def} & \exists%
{y {:} D}. (\mathbf{Sat}(a \mbox{\aap ,} t, \alpha[x := y]) \\ 
&  & 
\end{array}%
\end{equation*}

%-------------------------------------%
%           function Par
%-------------------------------------%

\begin{equation*}
\begin{array}{lll}
\mathbf{Par}_{X,l}(c) & =_{def} & [] \\ 
\mathbf{Par}_{X,l}(\lnot \varphi ) & =_{def} & \mathbf{Par}_{X,l}(\varphi )
\\ 
\mathbf{Par}_{X,l}(\varphi \wedge \psi ) & =_{def} & \mathbf{Par}%
_{X,l}(\varphi )++\mathbf{Par}_{X,l}(\psi ) \\ 
\mathbf{Par}_{X,l}(\varphi \vee \psi ) & =_{def} & \mathbf{Par}%
_{X,l}(\varphi )++\mathbf{Par}_{X,l}(\psi ) \\ 
\mathbf{Par}_{X,l}(\varphi \Rightarrow \psi ) & =_{def} & \mathbf{Par}%
_{X,l}(\varphi )++\mathbf{Par}_{X,l}(\psi ) \\ 
\mathbf{Par}_{X,l}([\alpha ]\varphi ) & =_{def} & \mathbf{Par}_{X,l}(\varphi
) \\ 
\mathbf{Par}_{X,l}(\langle \alpha \rangle \varphi ) & =_{def} & \mathbf{Par}%
_{X,l}(\varphi ) \\ 
\mathbf{Par}_{X,l}(\forall {x{:}D}.\varphi ) & =_{def} & \mathbf{Par}%
_{X,l++[x{:}D]}(\varphi ) \\ 
\mathbf{Par}_{X,l}(\exists {x{:}D}.\varphi ) & =_{def} & \mathbf{Par}%
_{X,l++[x{:}D]}(\varphi ) \\ 
\mathbf{Par}_{X,l}(Y(d_{f})) & =_{def} & [] \\ 
\mathbf{Par}_{X,l}(\sigma Y(x_{f}{:}D_{f}:=d).\varphi ) & =_{def} & \left\{ 
\begin{array}{cc}
l & \mathsf{if\ }Y=X \\ 
\mathbf{Par}_{X,l++[x_{f}{:}D_{f}]}(\varphi ) & \mathsf{if\ }Y\neq X%
\end{array}%
\right. \\ 
\mathbf{Par}_{X,l}(\nabla (t)) & =_{def} & [] \\ 
\mathbf{Par}_{X,l}(\Delta (t)) & =_{def} & [] \\ 
&  & 
\end{array}%
\end{equation*}

\pagebreak

%-------------------------------------%
%           function RHS
%-------------------------------------%
\begin{equation*}
\begin{array}{lll}
{\mathbf{RHS}}(c) & =_{def} & c \\ 
{\mathbf{RHS}}(\varphi \wedge \psi ) & =_{def} & {\mathbf{RHS}}(\varphi
)\wedge {\mathbf{RHS}}(\psi ) \\ 
{\mathbf{RHS}}(\varphi \vee \psi ) & =_{def} & {\mathbf{RHS}}(\varphi )\vee {%
\mathbf{RHS}}(\psi ) \\ 
{\mathbf{RHS}}(\forall {x{:}D}.\varphi ) & =_{def} & \forall {x{:}D}.{%
\mathbf{RHS}}(\varphi ) \\ 
{\mathbf{RHS}}(\exists {x{:}D}.\varphi ) & =_{def} & \exists {x{:}D}.{%
\mathbf{RHS}}(\varphi ) \\ 
{\mathbf{RHS}}([\alpha ]\varphi ) & =_{def} & \bigwedge_{i{\in }I}\forall _{y%
{:}E_{i}}((\mathbf{Sat}(a_{i}(f_{i}(x,y))\mbox{\aap ,}t_{i}(x,y),\alpha )\
\wedge \\ 
&  & \phantom{\bigwedge_{i {\in} I} \forall_{y {:} E_i}(}c_{i}(x,y)\wedge
t_{i}(x,y)>T\ )\Rightarrow \\ 
&  & \phantom{\bigwedge_{i {\in} I} \forall_{y {:} E_i}(} {\mathbf{RHS}}%
(\varphi )[T,x:=t_{i}(x,y),g_{i}(x,y)]) \\ 
{\mathbf{RHS}}(\langle \alpha \rangle \varphi ) & =_{def} & \bigvee_{i{\in }%
I}\exists _{y{:}E_{i}}(\mathbf{Sat}(a_{i}(f_{i}(x,y))\mbox{\aap
,}t_{i}(x,y),\alpha )\ \wedge \\ 
&  & \phantom{\bigvee_{i {\in} I} \exists_{y {:} E_i}(}c_{i}(x,y)\wedge
t_{i}(x,y)>T\ \wedge \\ 
&  & \phantom{\bigvee_{i {\in} I} \exists_{y {:} E_i}(} {\mathbf{RHS}}%
(\varphi )[T,x:=t_{i}(x,y),g_{i}(x,y)]) \\ 
{\mathbf{RHS}}(X(e)) & =_{def} & X(T,e,x,\mathbf{Par}_{X,[]}(\varphi _{0}))
\\ 
{\mathbf{RHS}}(\sigma X(x_{f}{:}D_{f}:=e).~\varphi ) & =_{def}~~~ & X(T,e,x,%
\mathbf{Par}_{X,[]}(\varphi _{0})) \\ 
{\mathbf{RHS}}(\nabla (t)) & =_{def} & \left( \bigwedge_{i{\in }I\cup
J}\forall _{y{:}E_{i}}((\lnot c_{i}(x,y)\vee t>t_{i}(x,y))\right) \wedge t>T
\\ 
{\mathbf{RHS}}(\Delta (t)) & =_{def} & \left( \bigvee_{i{\in }I\cup
J}\exists _{y{:}E_{i}}((c_{i}(x,y)\wedge t\leq t_{i}(x,y))\right) \vee t\leq
T%
\end{array}%
\end{equation*}

%-------------------------------------%
%           function E
%-------------------------------------%
\begin{equation*}
\begin{array}{lll}
{\mathbf{E}}(c) & =_{def} & \epsilon  \\ 
{\mathbf{E}}(\varphi \wedge \psi ) & =_{def} & {\mathbf{E}}(\varphi ){%
\mathbf{E}}(\psi ) \\ 
{\mathbf{E}}(\varphi \vee \psi ) & =_{def} & {\mathbf{E}}(\varphi ){\mathbf{E%
}}(\psi ) \\ 
{\mathbf{E}}(\forall {x{:}D}.\varphi ) & =_{def} & {\mathbf{E}}(\varphi ) \\ 
{\mathbf{E}}(\exists {x{:}D}.\varphi ) & =_{def} & {\mathbf{E}}(\varphi ) \\ 
{\mathbf{E}}([\alpha ]\varphi ) & =_{def} & {\mathbf{E}}(\varphi ) \\ 
{\mathbf{E}}(\langle \alpha \rangle \varphi ) & =_{def} & {\mathbf{E}}%
(\varphi ) \\ 
{\mathbf{E}}(\nabla ) & =_{def} & \epsilon  \\ 
{\mathbf{E}}(\nabla (t)) & =_{def} & \epsilon  \\ 
{\mathbf{E}}(\Delta ) & =_{def} & \epsilon  \\ 
{\mathbf{E}}(\Delta (t)) & =_{def} & \epsilon  \\ 
{\mathbf{E}}(X(e)) & =_{def} & \epsilon  \\ 
{\mathbf{E}}(\sigma X(x_{f}{:}D_{f}:=e).~\varphi )~~~ & =_{def}~~~ & (%
\widetilde{\sigma }X(T:\mathbb{R},x_{f}{:}D_{f},x{:}D_{p},\mathbf{Par}%
_{X,[]}(\varphi _{0}))={\mathbf{RHS}}(\varphi )~)~{\mathbf{E}}(\varphi )%
\end{array}%
\end{equation*}%
where $\widetilde{\sigma }=\mu $ if $\sigma =\nu $ and $\widetilde{\sigma }%
=\nu $ if $\sigma =\mu $.

\subsection{Counter example generation}

In counter example generation, the function RHS is adapted as follows:%
\begin{equation*}
\begin{array}{lll}
{\mathbf{RHS}}([\alpha ]\varphi ) & =_{def} & \bigwedge_{i{\in }I}\forall _{y%
{:}E_{i},d^{\prime }{:}D_{p}}\left( \mathbf{Sat}(a_{i}(f_{i}(x,y))\mbox{\aap
,}t_{i}(x,y),\alpha )\ \wedge c_{i}(x,y)\wedge t_{i}(x,y)>T\ \wedge
d^{\prime }=g_{i}(x,y)\right) \Rightarrow  \\ 
&  & \phantom{\bigwedge_{i {\in} I} \forall_{y {:} E_i}(}\left( \left( {%
\mathbf{RHS}}(\varphi )[T,x:=t_{i}(x,y),g_{i}(x,y)][x:=d^{\prime }]\wedge
Z_{a_{i}}^{+}(x,f_{i}(x,y),d^{\prime })\right) \vee
Z_{a_{i}}^{-}(x,f_{i}(x,y),d^{\prime })\right)  \\ 
{\mathbf{RHS}}(\langle \alpha \rangle \varphi ) & =_{def} & \bigvee_{i{\in }%
I}\exists _{y{:}E_{i},d^{\prime }{:}D_{p}}\left( \mathbf{Sat}%
(a_{i}(f_{i}(x,y))\mbox{\aap
,}t_{i}(x,y),\alpha )\ \wedge c_{i}(x,y)\wedge t_{i}(x,y)>T\ \wedge
d^{\prime }=g_{i}(x,y)\right) \wedge  \\ 
&  & \phantom{\bigwedge_{i {\in} I} \forall_{y {:} E_i}(}\left( \left( {%
\mathbf{RHS}}(\varphi )[T,x:=t_{i}(x,y),g_{i}(x,y)][x:=d^{\prime }]\vee
Z_{a_{i}}^{-}(x,f_{i}(x,y),d^{\prime })\right) \wedge
Z_{a_{i}}^{+}(x,f_{i}(x,y),d^{\prime })\right) ,%
\end{array}%
\end{equation*}%
where $\nu Z_{a_{i}}^{+}(x,f_{i}(x,y),d^{\prime })=true$ and $\nu
Z_{a_{i}}^{-}(x,f_{i}(x,y),d^{\prime })=false$ are additional equations for
every $a_{i}$ that appears in the LPS.

\newpage 

\section{Transforming an LTS to a PBES}

In this section we define the algorithm \textsc{lts2pbes} that generates a
PBES from a state formula $\sigma X(d:D:=e).~\varphi $ and an LTS $\langle {%
S,Act,\rightarrow ,s}_{0}\rangle $ : 
\begin{equation*}
\text{\textsc{lts2pbes}}(\sigma X(d:D:=e).~\varphi ,\langle {%
S,Act,\rightarrow ,s}_{0}\rangle )=\left\langle \mathbf{E}_{\sigma
X(d:D:=e).~\varphi }(\varphi ),X_{s_{0}}(e)\right\rangle
\end{equation*}%
where the function $\mathbf{E}$ is inductively defined using the tables
below. The function $\varphi $ has to be in positive normal form, i.e. it
may not contain any $\lnot $ or $\Rightarrow $ symbols. A formula $\psi $
not of the form $\sigma X(d:D:=e).~\varphi $ is translated into $\nu
X().~\psi $.

N.B. The functions $\mathbf{Sat}$ and $\mathbf{Par}$ are defined in the
section about \textsc{lps2pbes}.

$\bigskip$

$%
\begin{array}{lll}
{\mathbf{E}}_{\varphi _{0}}(c) & =_{def} & \epsilon \\ 
{\mathbf{E}}_{\varphi _{0}}(\varphi \wedge \psi ) & =_{def} & {\mathbf{E}}%
_{\varphi _{0}}(\varphi ){\mathbf{E}}_{\varphi _{0}}(\psi ) \\ 
{\mathbf{E}}_{\varphi _{0}}(\varphi \vee \psi ) & =_{def} & {\mathbf{E}}%
_{\varphi _{0}}(\varphi ){\mathbf{E}}_{\varphi _{0}}(\psi ) \\ 
{\mathbf{E}}_{\varphi _{0}}(\forall {x{:}D}.\varphi ) & =_{def} & {\mathbf{E}%
}_{\varphi _{0}}(\varphi ) \\ 
{\mathbf{E}}_{\varphi _{0}}(\exists {x{:}D}.\varphi ) & =_{def} & {\mathbf{E}%
}_{\varphi _{0}}(\varphi ) \\ 
{\mathbf{E}}_{\varphi _{0}}([\alpha ]\varphi ) & =_{def} & {\mathbf{E}}%
_{\varphi }(\varphi ) \\ 
{\mathbf{E}}_{\varphi _{0}}(\langle \alpha \rangle \varphi ) & =_{def} & {%
\mathbf{E}}_{\varphi _{0}}(\varphi ) \\ 
{\mathbf{E}}_{\varphi _{0}}(X(d)) & =_{def} & \epsilon \\ 
{\mathbf{E}}_{\varphi _{0}}(\sigma X(d{:}D:=e).~\varphi )~~~ & =_{def}~~~ & 
(\sigma \{X_{s}(d:D,\mathbf{Par}_{X,[]}(\varphi _{0}))={\mathbf{RHS}}%
_{\varphi }(\varphi ,s)\ |\ s\in S\})~{\mathbf{E}}_{\varphi _{0}}(\varphi )%
\end{array}%
$

$\bigskip $

$%
\begin{array}{lll}
{\mathbf{RHS}}_{\varphi _{0}}(c,s) & =_{def} & c \\ 
{\mathbf{RHS}}_{\varphi _{0}}(\varphi \wedge \psi ,s) & =_{def} & {\mathbf{%
RHS}}_{\varphi _{0}}(\varphi ,s)\wedge {\mathbf{RHS}}_{\varphi _{0}}(\psi ,s)
\\ 
{\mathbf{RHS}}_{\varphi _{0}}(\varphi \vee \psi ,s) & =_{def} & {\mathbf{RHS}%
}_{\varphi _{0}}(\varphi ,s)\vee {\mathbf{RHS}}_{\varphi _{0}}(\psi ,s) \\ 
{\mathbf{RHS}}_{\varphi _{0}}(\forall d{{:}D}.\varphi ,s) & =_{def} & 
\forall d{{:}D}.{\mathbf{RHS}}_{\varphi _{0}}(\varphi ,s) \\ 
{\mathbf{RHS}}_{\varphi _{0}}(\exists d{{:}D}.\varphi ,s) & =_{def} & 
\exists d{{:}D}.{\mathbf{RHS}}_{\varphi _{0}}(\varphi ,s) \\ 
{\mathbf{RHS}}_{\varphi _{0}}([\alpha ]\varphi ,s) & =_{def} & \bigwedge
\left\{ \mathbf{Sat}(a,\alpha )\Rightarrow {\mathbf{RHS}}_{\varphi
_{0}}(\varphi ,t)\ |\ s\overset{a}{\rightarrow }t\right\} \\ 
{\mathbf{RHS}}_{\varphi _{0}}(\langle \alpha \rangle \varphi ,s) & =_{def} & 
\bigvee \left\{ \mathbf{Sat}(a,\alpha )\wedge {\mathbf{RHS}}_{\varphi
_{0}}(\varphi ,t)\ |\ s\overset{a}{\rightarrow }t\right\} \\ 
{\mathbf{RHS}}_{\varphi _{0}}(X(e),s) & =_{def} & X_{s}(e,\mathbf{Par}%
_{X,[]}(\varphi _{0})) \\ 
{\mathbf{RHS}}_{\varphi _{0}}(\sigma X(d{:}D:=e).~\varphi ,s) & =_{def}~~~ & 
X_{s}(e,\mathbf{Par}_{X,[]}(\varphi _{0}))%
\end{array}%
$\pagebreak
