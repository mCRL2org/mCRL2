project libraries/core/test
   : source-location .
   : requirements
      <use>/libraries//utilities
      <use>/libraries//atermpp
      <use>/libraries//core
      <use>/site-config//boost
      <toolset>msvc:<asynch-exceptions>on
      <library>/libraries//core
   ;

include $(TOP)/build/testing/header_test.jam ;

use-project /tools/mcrl22lps : ../../../tools/mcrl22lps ;
use-project /tools/lpspp : ../../../tools/lpspp ;

for file in [ glob-tree *.mcrl2 : .svn ] {
  tests-with-files += [
        run /tools/mcrl22lps//mcrl22lps
              : -D
              : $(file)
              : <testing.preserve>true
                <testing.post-pipes>/tools/lpspp//lpspp
              : mcrl22lps-core-$(file:B) ] ;
}

test-suite core
    : [ run test_lib.cpp ]
      $(tests-with-files)
      [ run beta_reduce_test.cpp ]
      [ run text_utility_test.cpp ]
      [ run sequence_test.cpp ]
      [ run reachable_nodes_test.cpp ]
      [ compile-headers ../include ]
    ;
